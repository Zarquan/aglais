#
# <meta:header>
#   <meta:licence>
#     Copyright (c) 2020, ROE (http://www.roe.ac.uk/)
#
#     This information is free software: you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation, either version 3 of the License, or
#     (at your option) any later version.
#
#     This information is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License
#     along with this program.  If not, see <http://www.gnu.org/licenses/>.
#   </meta:licence>
# </meta:header>
#
#zrq-notes-time
#zrq-notes-indent
#zrq-notes-crypto
#zrq-notes-ansible
#zrq-notes-osformat
#

# -----------------------------------------------------
# -----------------------------------------------------

    Debugging line at a time in Eclipse, managed to 'see' the XML we are getting back from Swift,
    and it doesn't match the S3 schema.

    https://docs.openstack.org/swift/latest/s3_compat.html


        Getting (Swift XML)
        https://opendev.org/openstack/swift/src/branch/master/swift/common/middleware/listing_formats.py#L57
        https://opendev.org/openstack/swift/src/branch/master/swift/common/middleware/listing_formats.py#L92

            <container>
                <object>
                    <name>
                    <hash>
                    <bytes>
                    <content_type>
                    <last_modified>

        Expecting (S3 XML)
        https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListObjectsV2.html

            <ListBucketResult>
               <IsTruncated>boolean</IsTruncated>
               <Contents>
                  <ETag>string</ETag>
                  <Key>string</Key>
                  <LastModified>timestamp</LastModified>
                  <Owner>
                     <DisplayName>string</DisplayName>
                     <ID>string</ID>
                  </Owner>
                  <Size>integer</Size>
                  <StorageClass>string</StorageClass>
               </Contents>


    Turns out Swift has two modes.
    Swift API, that can produce text, JSON and XML.

    Turns out that the Amazon code just skips things it doesn't recognise.
    So even though the XML comming back from Swift means nothing to the S3 parser,
    it just fails silently and returns an empty list.

    Need to find the selector in Swift that chooses which XML format to return.
    Possibly a different endpoint path ?

# -----------------------------------------------------
# Checkout a copy of the Swift source code.
#[user@desktop]

    source "${HOME}/aglais.env"
    pushd "${AGLAIS_HOME}"

        mkdir 'external'
        pushd 'external'

            mkdir 'openstack'
            pushd 'openstack'

                git clone 'https://opendev.org/openstack/swift.git'

            popd
        popd
    popd

